<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="101.47483mm"
   height="289.59555mm"
   viewBox="0 0 101.47483 289.59555"
   version="1.1"
   id="svg8"
   inkscape:version="1.0 (4035a4fb49, 2020-05-01)"
   sodipodi:docname="intra_rdo.svg"
   inkscape:export-filename="/home/thomas/sandbox/rav1e/doc/rdo_intra.png"
   inkscape:export-xdpi="300"
   inkscape:export-ydpi="300">
  <defs
     id="defs2">
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker1997"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Lend">
      <path
         transform="matrix(-0.8,0,0,-0.8,-10,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path1995" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker1406"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Lend">
      <path
         transform="matrix(-0.8,0,0,-0.8,-10,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path1404" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Lend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker1366"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path1364"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1"
         transform="matrix(-0.8,0,0,-0.8,-10,0)" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker1332"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Lend"
       inkscape:collect="always">
      <path
         transform="matrix(-0.8,0,0,-0.8,-10,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path1330" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Lend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker1302"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path1300"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill-rule:evenodd;stroke:#000000;stroke-width:1pt"
         transform="matrix(-0.8,0,0,-0.8,-10,0)" />
    </marker>
    <rect
       x="72.805893"
       y="257.92346"
       width="80.012253"
       height="17.834499"
       id="rect1276" />
    <rect
       x="76.565414"
       y="231.13281"
       width="70.119621"
       height="11.541659"
       id="rect1264" />
    <rect
       x="76.046013"
       y="203.56802"
       width="72.0923"
       height="14.71183"
       id="rect1250" />
    <rect
       x="77.237236"
       y="183.22475"
       width="71.429352"
       height="12.735497"
       id="rect1242" />
    <rect
       x="60.212902"
       y="161.47203"
       width="91.92662"
       height="7.8322501"
       id="rect1226" />
    <rect
       x="58.364983"
       y="139.76839"
       width="90.375206"
       height="11.874702"
       id="rect1218" />
    <rect
       x="58.757534"
       y="121.3649"
       width="91.994484"
       height="8.0687208"
       id="rect1210" />
    <rect
       x="77.266472"
       y="98.816643"
       width="64.397865"
       height="11.443521"
       id="rect1200" />
    <rect
       x="78.16172"
       y="82.550789"
       width="61.197414"
       height="8.2947512"
       id="rect1194" />
    <rect
       x="82.047569"
       y="66.658173"
       width="62.792156"
       height="14.793264"
       id="rect1182" />
    <rect
       x="80.460655"
       y="63.184708"
       width="66.944229"
       height="13.43969"
       id="rect1176" />
    <marker
       inkscape:collect="always"
       inkscape:stockid="Arrow1Lend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow1Lend"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path901"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1pt;stroke-opacity:1"
         transform="matrix(-0.8,0,0,-0.8,-10,0)" />
    </marker>
    <rect
       x="43.978367"
       y="84.580368"
       width="84.359032"
       height="6.3445196"
       id="rect848" />
    <rect
       id="rect848-3"
       height="6.3445196"
       width="84.359032"
       y="84.580368"
       x="43.978367" />
    <rect
       id="rect869"
       height="6.3445196"
       width="84.359032"
       y="84.580368"
       x="43.978367" />
    <rect
       x="43.978367"
       y="84.580368"
       width="84.359032"
       height="6.3445196"
       id="rect1973" />
    <rect
       id="rect1975"
       height="14.793264"
       width="62.792156"
       y="66.658173"
       x="82.047569" />
    <rect
       id="rect1977"
       height="13.69431"
       width="66.816338"
       y="82.550789"
       x="78.16172" />
    <rect
       id="rect1979"
       height="11.443521"
       width="64.397865"
       y="98.816643"
       x="77.266472" />
  </defs>
  <sodipodi:namedview
     fit-margin-bottom="0"
     fit-margin-right="0"
     fit-margin-left="0"
     fit-margin-top="0"
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="0.98994949"
     inkscape:cx="433.33383"
     inkscape:cy="394.20423"
     inkscape:document-units="mm"
     inkscape:current-layer="layer1"
     inkscape:document-rotation="0"
     showgrid="false"
     inkscape:window-width="1920"
     inkscape:window-height="1021"
     inkscape:window-x="0"
     inkscape:window-y="22"
     inkscape:window-maximized="1" />
  <metadata
     id="metadata5">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     transform="translate(-54.79473,18.50007)"
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1">
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264583"
       id="rect844"
       width="98.58905"
       height="14.005027"
       x="54.927021"
       y="-18.367779" />
    <text
       xml:space="preserve"
       id="text846"
       style="font-style:normal;font-weight:normal;font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect848);fill:#000000;fill-opacity:1;stroke:none;"
       transform="translate(17.584654,-98.857694)"><tspan
         x="43.978516"
         y="88.325583"><tspan
           style="font-size:4.23333px">Initial intra_mode_set</tspan></tspan></text>
    <rect
       rx="4"
       y="51.423546"
       x="55.217525"
       height="49.120174"
       width="98.432442"
       id="rect844-6"
       style="fill:#ffd5d5;fill-opacity:1;stroke:#000000;stroke-width:0.264584"
       ry="4" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1204"
       width="69.786583"
       height="13.712702"
       x="75.191475"
       y="84.648224" />
    <text
       transform="translate(13.112648,-29.066342)"
       style="font-style:normal;font-weight:normal;font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect848-3);fill:#000000;fill-opacity:1;stroke:none;"
       id="text846-7"
       xml:space="preserve"><tspan
         x="43.978516"
         y="88.325583"><tspan>Foreach intra mode:</tspan></tspan></text>
    <path
       style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.265;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend)"
       d="m 104.26245,-4.362752 0.0328,6.0446048"
       id="path896"
       inkscape:connector-type="polyline"
       inkscape:connector-curvature="0"
       inkscape:connection-start="#rect844" />
    <text
       xml:space="preserve"
       id="text1174"
       style="font-style:normal;font-weight:normal;font-size:10.5833px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1176);fill:#000000;fill-opacity:1;stroke:none;" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1188"
       width="69.786583"
       height="12.809623"
       x="75.191475"
       y="62.163654" />
    <text
       xml:space="preserve"
       id="text1180"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1182);"
       transform="translate(-4.3734065,-3.3523533)"><tspan
         x="82.046875"
         y="70.403708"><tspan>Compute prediction at </tspan></tspan><tspan
         x="82.046875"
         y="75.695372"><tspan>partition size</tspan></tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1190"
       width="69.786583"
       height="9.6749477"
       x="75.191475"
       y="74.973274" />
    <text
       xml:space="preserve"
       id="text1192"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1194);"
       transform="translate(0,-4.7625002)"><tspan
         x="78.162109"
         y="86.296286"><tspan>Compute SATD of residual</tspan></tspan></text>
    <text
       xml:space="preserve"
       id="text1198"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1200);"
       transform="translate(0,-12.700002)"><tspan
         x="77.265625"
         y="102.56191"><tspan>Push intra mode + SATD to </tspan></tspan><tspan
         x="77.265625"
         y="107.85358"><tspan>list</tspan></tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1206"
       width="98.049286"
       height="9.9740601"
       x="55.65992"
       y="117.99167" />
    <text
       xml:space="preserve"
       id="text1208"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1210);"><tspan
         x="58.757812"
         y="125.11074"><tspan>Sort list from low to high SATD</tspan></tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1214"
       width="97.610794"
       height="8.6716423"
       x="56.601631"
       y="137.40891" />
    <text
       xml:space="preserve"
       id="text1216"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1218);"><tspan
         x="58.365234"
         y="143.51308"><tspan>Prune list to first N entries</tspan></tspan></text>
    <rect
       rx="4"
       style="fill:#d7eef4;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1222"
       width="98.732582"
       height="88.848846"
       x="57.404476"
       y="159.89868"
       ry="4" />
    <text
       xml:space="preserve"
       id="text1224"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1226);"><tspan
         x="60.212891"
         y="165.21816"><tspan>Foreach intra_mode:</tspan></tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1230"
       width="80.714874"
       height="12.091858"
       x="70.137367"
       y="168.68153" />
    <text
       xml:space="preserve"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;stroke-width:0.264583"
       x="76.838943"
       y="174.07181"
       id="text1234"><tspan
         sodipodi:role="line"
         id="tspan1232"
         x="76.838943"
         y="174.07181"
         style="stroke-width:0.264583">Save entropy decoding context</tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1236"
       width="80.714867"
       height="18.551733"
       x="70.137367"
       y="180.77339" />
    <text
       xml:space="preserve"
       id="text1240"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1242);"><tspan
         x="77.236328"
         y="186.97011"><tspan>Code entire partition (with </tspan></tspan><tspan
         x="77.236328"
         y="192.26177"><tspan>bitstream writing disabled)</tspan></tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1246"
       width="80.784828"
       height="16.034088"
       x="70.137367"
       y="199.32512" />
    <text
       xml:space="preserve"
       id="text1248"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1250);"
       transform="translate(0,-2.1166667)"><tspan
         x="76.046875"
         y="207.31386"><tspan>Compute distortion with either </tspan></tspan><tspan
         x="76.046875"
         y="212.60552"><tspan>MSE or psychovisual metric</tspan></tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1254"
       width="80.866783"
       height="13.103516"
       x="70.055412"
       y="215.35921" />
    <text
       xml:space="preserve"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;stroke-width:0.264583"
       x="76.836853"
       y="221.31117"
       id="text1258"><tspan
         sodipodi:role="line"
         id="tspan1256"
         x="76.836853"
         y="221.31117"
         style="stroke-width:0.264583">Measure rate (bits used)</tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none"
       id="rect1260"
       width="80.866776"
       height="14.351123"
       x="70.055412"
       y="228.46272" />
    <text
       xml:space="preserve"
       id="text1262"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1264);"><tspan
         x="76.564453"
         y="234.87832"><tspan>Save mode and RDO score if it is </tspan></tspan><tspan
         x="76.564453"
         y="240.16997"><tspan>better than previous best</tspan></tspan></text>
    <path
       style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker1302)"
       d="m 104.56483,100.54372 0.0931,17.44795"
       id="path1298"
       inkscape:connector-type="polyline"
       inkscape:connector-curvature="0"
       inkscape:connection-start="#rect844-6"
       inkscape:connection-end="#rect1206" />
    <path
       style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker1332)"
       d="m 104.87656,127.96573 0.36355,9.44318"
       id="path1324"
       inkscape:connector-type="polyline"
       inkscape:connector-curvature="0"
       inkscape:connection-start="#rect1206"
       inkscape:connection-end="#rect1214" />
    <path
       style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker1366)"
       d="m 105.50152,146.08055 0.30113,13.81813"
       id="path1326"
       inkscape:connector-type="polyline"
       inkscape:connector-curvature="0"
       inkscape:connection-start="#rect1214"
       inkscape:connection-end="#rect1222" />
    <path
       style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker1406)"
       d="m 106.77997,249.22355 10e-4,21.35829"
       id="path1328"
       inkscape:connector-type="polyline"
       inkscape:connector-curvature="0" />
    <text
       xml:space="preserve"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;stroke-width:0.264583"
       x="108.39085"
       y="133.86757"
       id="text4104"><tspan
         sodipodi:role="line"
         id="tspan4102"
         x="108.39085"
         y="133.86757"
         style="stroke-width:0.264583">intra_mode_set</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;stroke-width:0.264583"
       x="111.10286"
       y="260.3562"
       id="text4120"><tspan
         sodipodi:role="line"
         id="tspan4118"
         x="111.10286"
         y="260.3562"
         style="stroke-width:0.264583">PartitionParameters</tspan></text>
    <text
       id="text4136"
       y="110.28521"
       x="107.6094"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;stroke-width:0.264583"
       xml:space="preserve"><tspan
         style="stroke-width:0.264583"
         y="110.28521"
         x="107.6094"
         id="tspan4134"
         sodipodi:role="line">intra_mode_set</tspan></text>
    <text
       id="text4140"
       y="153.60532"
       x="108.21284"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;stroke-width:0.264583"
       xml:space="preserve"><tspan
         style="stroke-width:0.264583"
         y="153.60532"
         x="108.21284"
         id="tspan4138"
         sodipodi:role="line">intra_mode_set</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;stroke-width:0.264583"
       x="108.21284"
       y="153.60532"
       id="text4144"><tspan
         sodipodi:role="line"
         id="tspan4142"
         x="108.21284"
         y="153.60532"
         style="stroke-width:0.264583">intra_mode_set</tspan></text>
    <rect
       rx="4"
       ry="4"
       style="fill:#d7f4ee;fill-opacity:1;stroke:#000000;stroke-width:0.264584"
       id="rect1933"
       width="98.432442"
       height="43.35075"
       x="55.217525"
       y="2.2110181" />
    <text
       xml:space="preserve"
       id="text1941"
       style="font-style:normal;font-weight:normal;font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1973);fill:#000000;fill-opacity:1;stroke:none;"
       transform="translate(13.112648,-78.80804)"><tspan
         x="43.978516"
         y="88.325583"><tspan>Foreach intra mode:</tspan></tspan></text>
    <rect
       y="12.951113"
       x="75.191475"
       height="12.809623"
       width="69.786583"
       id="rect1943"
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264999;stroke-miterlimit:4;stroke-dasharray:none" />
    <text
       transform="translate(-4.3734065,-52.56488)"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1975);"
       id="text1953"
       xml:space="preserve"><tspan
         x="82.046875"
         y="70.403708"><tspan
           style="shape-inside:url(#rect1975)">Estimate rate of each mode</tspan></tspan></text>
    <rect
       y="25.760727"
       x="75.191475"
       height="16.509342"
       width="69.786583"
       id="rect1955"
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.264998;stroke-miterlimit:4;stroke-dasharray:none" />
    <text
       transform="translate(0,-53.975028)"
       style="font-size:4.23333px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;white-space:pre;shape-inside:url(#rect1977);"
       id="text1961"
       xml:space="preserve"><tspan
         x="78.162109"
         y="86.296286"><tspan>Sort from lowest to highest </tspan></tspan><tspan
         x="78.162109"
         y="91.58795"><tspan>rate</tspan></tspan></text>
    <path
       inkscape:connector-curvature="0"
       inkscape:connector-type="polyline"
       id="path1993"
       d="m 104.2611,45.836724 0.0341,4.528488"
       style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.265;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker1997)" />
  </g>
</svg>
